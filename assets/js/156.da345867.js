(window.webpackJsonp=window.webpackJsonp||[]).push([[156],{631:function(v,_,t){"use strict";t.r(_);var e=t(11),d=Object(e.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("h1",{attrs:{id:"发送消息"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#发送消息"}},[v._v("#")]),v._v(" 发送消息")]),v._v(" "),_("div",{staticClass:"custom-block tip"},[_("p",{staticClass:"custom-block-title"},[v._v("说明")]),v._v(" "),_("p",[v._v("发送消息分为，主动推送与被动回复，主动消息和被动消息在不同的场景下，发送的频次有不同的规则。\n发送消息的接口有"),_("code",[v._v("4")]),v._v("个场景：QQ单聊、QQ群聊、文字子频道、频道私信")])]),v._v(" "),_("p",[v._v("主动消息与被动消息说明：\nQQ 用户可以在 QQ 客户端主动设置是否接收机器人发送的主动消息，如果设置了关闭，主动消息一律发送失败。")]),v._v(" "),_("ul",[_("li",[v._v("单聊\n"),_("ul",[_("li",[v._v("主动消息每月 "),_("code",[v._v("4 条")]),v._v("，超额会发送失败。（例如：给相同用户每月最多发 4 条）")]),v._v(" "),_("li",[v._v("被动消息（回复类）有效时间为 "),_("code",[v._v("60 分钟")]),v._v("，每个消息最多回复 "),_("code",[v._v("5 次")]),v._v("，超时或超频会发送（回复）失败；")])])]),v._v(" "),_("li",[v._v("群聊\n"),_("ul",[_("li",[v._v("主动消息每月 "),_("code",[v._v("4 条")]),v._v("，超额会发送失败。（例如：给相同群每月最多发 4 条）")]),v._v(" "),_("li",[v._v("被动消息（回复类）有效时间为 "),_("code",[v._v("5 分钟")]),v._v("，每个消息最多回复 "),_("code",[v._v("5 次")]),v._v("，超时或超频会发送（回复）失败；")])])]),v._v(" "),_("li",[v._v("文字子频道\n"),_("ul",[_("li",[v._v("主动消息在频道主或管理设置了情况下，按设置的数量进行限频。在未设置的情况遵循如下限制:\n"),_("ul",[_("li",[v._v("主动推送消息，默认每天往每个子频道可推送的消息数是 "),_("code",[v._v("20")]),v._v(" 条，超过会被限制。")]),v._v(" "),_("li",[v._v("主动推送消息在每个频道中，每天可以往 "),_("code",[v._v("2")]),v._v(" 个子频道推送消息。超过后会被限制。")])])]),v._v(" "),_("li",[v._v("不论主动消息还是被动消息，在一个子频道中，"),_("code",[v._v("每秒")]),v._v(" 最多可发送 "),_("code",[v._v("5 条")]),v._v(" 消息。")]),v._v(" "),_("li",[v._v("被动回复消息有效期为 "),_("code",[v._v("5 分钟")]),v._v("，超时会发送失败。")]),v._v(" "),_("li",[v._v("发送消息接口要求机器人接口需要连接到 "),_("code",[v._v("WebSocket")]),v._v(" 上保持在线状态")]),v._v(" "),_("li",[v._v("有关主动消息审核，可以通过 "),_("code",[v._v("事件订阅 Intents")]),v._v(" 中审核事件 "),_("code",[v._v("MESSAGE_AUDIT")]),v._v(" 返回 "),_("code",[v._v("MessageAudited")]),v._v(" 对象获取结果。")])])]),v._v(" "),_("li",[v._v("频道私信\n"),_("ul",[_("li",[v._v("私信场景下，每个机器人每天可以对一个用户发 "),_("code",[v._v("2 条")]),v._v(" 主动消息。")]),v._v(" "),_("li",[v._v("私信场景下，每个机器人每天累计可以发 "),_("code",[v._v("200 条")]),v._v(" 主动消息。\n")]),v._v(" "),_("li",[v._v("被动回复消息有效期为 "),_("code",[v._v("5 分钟")]),v._v("，超时会发送失败。")])])])]),v._v(" "),_("p",[v._v("发动的消息内容包含 URL 的说明：")]),v._v(" "),_("p",[v._v("如开发者需要在消息内容发送含有 url 信息的消息，请现在 q.qq.com 后台-开发设置-消息URL配置 预先配置，否则会发送失败。\n调用发消息 http 接口的 timeout 建议设置最低为 5 秒，避免出现实际消息已发送成功，但没接收到同步的结果返回。")]),v._v(" "),_("h2",{attrs:{id:"单聊"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#单聊"}},[v._v("#")]),v._v(" 单聊")]),v._v(" "),_("div",{staticClass:"custom-block tip"},[_("p",{staticClass:"custom-block-title"},[v._v("说明")]),v._v(" "),_("p",[v._v("单独发动消息给用户。")])]),v._v(" "),_("ul",[_("li",[_("strong",[v._v("请求")]),v._v(" "),_("table",[_("tr",[_("th",{attrs:{colspan:"2"}},[v._v("基本")])]),v._v(" "),_("tr",[_("td",[v._v("HTTP URL")]),v._v(" "),_("td",[v._v("/v2/users/{openid}/messages")])]),v._v(" "),_("tr",[_("td",[v._v("HTTP Method")]),v._v(" "),_("td",[v._v("POST")])])])]),v._v(" "),_("li",[_("strong",[v._v("路径参数")])])]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[_("strong",[v._v("属性")])]),v._v(" "),_("th",[_("strong",[v._v("类型")])]),v._v(" "),_("th",[_("strong",[v._v("必填")])]),v._v(" "),_("th",[_("strong",[v._v("说明")])])])]),v._v(" "),_("tbody",[_("tr",[_("td",[v._v("openid")]),v._v(" "),_("td",[v._v("string")]),v._v(" "),_("td",[v._v("是")]),v._v(" "),_("td",[v._v("QQ 用户的 openid，可在各类事件中获得。")])])])]),v._v(" "),_("ul",[_("li",[_("strong",[v._v("请求参数")])])]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[_("strong",[v._v("属性")])]),v._v(" "),_("th",[_("strong",[v._v("类型")])]),v._v(" "),_("th",[_("strong",[v._v("必填")])]),v._v(" "),_("th",[_("strong",[v._v("说明")])])])]),v._v(" "),_("tbody",[_("tr",[_("td",[v._v("content")]),v._v(" "),_("td",[v._v("string")]),v._v(" "),_("td",[v._v("否")]),v._v(" "),_("td",[v._v("文本内容")])]),v._v(" "),_("tr",[_("td",[v._v("msg_type")]),v._v(" "),_("td",[v._v("int")]),v._v(" "),_("td",[v._v("是")]),v._v(" "),_("td",[v._v("消息类型：0 是文本，2 是 markdown， 3 ark，4 embed，7 media 富媒体")])]),v._v(" "),_("tr",[_("td",[v._v("markdown")]),v._v(" "),_("td",[v._v("object")]),v._v(" "),_("td",[v._v("否")]),v._v(" "),_("td",[_("RouterLink",{attrs:{to:"/develop/api-v2/server-inter/message/type/markdown.html#数据结构与协议"}},[v._v("Markdown")]),v._v("对象")],1)]),v._v(" "),_("tr",[_("td",[v._v("keyboard")]),v._v(" "),_("td",[v._v("object")]),v._v(" "),_("td",[v._v("否")]),v._v(" "),_("td",[_("RouterLink",{attrs:{to:"/develop/api-v2/server-inter/message/trans/msg-btn.html#数据结构与协议"}},[v._v("Keyboard")]),v._v("对象")],1)]),v._v(" "),_("tr",[_("td",[v._v("ark")]),v._v(" "),_("td",[v._v("object")]),v._v(" "),_("td",[v._v("否")]),v._v(" "),_("td",[_("RouterLink",{attrs:{to:"/develop/api-v2/server-inter/message/type/ark.html#数据结构与协议"}},[v._v("Ark")]),v._v("对象")],1)]),v._v(" "),_("tr",[_("td",[v._v("media")]),v._v(" "),_("td",[v._v("object")]),v._v(" "),_("td",[v._v("否")]),v._v(" "),_("td",[_("RouterLink",{attrs:{to:"/develop/api-v2/server-inter/message/send-receive/rich-media.html#用于单聊"}},[v._v("富媒体单聊")]),v._v("的file_info")],1)]),v._v(" "),_("tr",[_("td",[v._v("message_reference")]),v._v(" "),_("td",[v._v("object")]),v._v(" "),_("td",[v._v("否")]),v._v(" "),_("td",[v._v("【暂未支持】消息引用")])]),v._v(" "),_("tr",[_("td",[v._v("event_id")]),v._v(" "),_("td",[v._v("string")]),v._v(" "),_("td",[v._v("否")]),v._v(" "),_("td",[v._v('前置收到的事件 ID，用于发送被动消息，支持事件："INTERACTION_CREATE"、"C2C_MSG_RECEIVE"、"FRIEND_ADD"')])]),v._v(" "),_("tr",[_("td",[v._v("msg_id")]),v._v(" "),_("td",[v._v("string")]),v._v(" "),_("td",[v._v("否")]),v._v(" "),_("td",[v._v("前置收到的用户发送过来的消息 ID，用于发送被动（回复）消息")])]),v._v(" "),_("tr",[_("td",[v._v("msg_seq")]),v._v(" "),_("td",[v._v("int")]),v._v(" "),_("td",[v._v("否")]),v._v(" "),_("td",[v._v("回复消息的序号，与 msg_id 联合使用，避免相同消息id回复重复发送，不填默认是1。相同的 msg_id + msg_seq 重复发送会失败。")])])])]),v._v(" "),_("ul",[_("li",[_("strong",[v._v("返回参数")])])]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[_("strong",[v._v("属性")])]),v._v(" "),_("th",[_("strong",[v._v("类型")])]),v._v(" "),_("th",[_("strong",[v._v("说明")])])])]),v._v(" "),_("tbody",[_("tr",[_("td",[v._v("id")]),v._v(" "),_("td",[v._v("string")]),v._v(" "),_("td",[v._v("消息唯一ID")])]),v._v(" "),_("tr",[_("td",[v._v("timestamp")]),v._v(" "),_("td",[v._v("int")]),v._v(" "),_("td",[v._v("发送时间")])])])]),v._v(" "),_("ul",[_("li",[_("strong",[v._v("常见错误码")])]),v._v(" "),_("li",[v._v("当 msg_type = 7 时，content 字段需要填入一个值，譬如一个空格 “ ”，后续版本会修复该问题。、")])]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[_("strong",[v._v("code")])]),v._v(" "),_("th",[_("strong",[v._v("message")])]),v._v(" "),_("th",[_("strong",[v._v("说明")])])])]),v._v(" "),_("tbody",[_("tr",[_("td",[v._v("22009")]),v._v(" "),_("td",[v._v("msg limit exceed")]),v._v(" "),_("td",[v._v("消息发送超频")])]),v._v(" "),_("tr",[_("td",[v._v("304082")]),v._v(" "),_("td",[v._v("upload media info fail")]),v._v(" "),_("td",[v._v("富媒体资源拉取失败，请重试")])]),v._v(" "),_("tr",[_("td",[v._v("304083")]),v._v(" "),_("td",[v._v("convert media info fail")]),v._v(" "),_("td",[v._v("富媒体资源拉取失败，请重试")])])])]),v._v(" "),_("h2",{attrs:{id:"群聊"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#群聊"}},[v._v("#")]),v._v(" 群聊")]),v._v(" "),_("div",{staticClass:"custom-block tip"},[_("p",{staticClass:"custom-block-title"},[v._v("说明")]),v._v(" "),_("p",[v._v("发动消息到群。")])]),v._v(" "),_("ul",[_("li",[_("strong",[v._v("请求")]),v._v(" "),_("table",[_("tr",[_("th",{attrs:{colspan:"2"}},[v._v("基本")])]),v._v(" "),_("tr",[_("td",[v._v("HTTP URL")]),v._v(" "),_("td",[v._v("/v2/groups/{group_openid}/messages")])]),v._v(" "),_("tr",[_("td",[v._v("HTTP Method")]),v._v(" "),_("td",[v._v("POST")])])])]),v._v(" "),_("li",[_("strong",[v._v("路径参数")])])]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[_("strong",[v._v("属性")])]),v._v(" "),_("th",[_("strong",[v._v("类型")])]),v._v(" "),_("th",[_("strong",[v._v("必填")])]),v._v(" "),_("th",[_("strong",[v._v("说明")])])])]),v._v(" "),_("tbody",[_("tr",[_("td",[v._v("group_openid")]),v._v(" "),_("td",[v._v("string")]),v._v(" "),_("td",[v._v("是")]),v._v(" "),_("td",[v._v("群聊的 openid")])])])]),v._v(" "),_("ul",[_("li",[_("strong",[v._v("请求参数")])])]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[_("strong",[v._v("属性")])]),v._v(" "),_("th",[_("strong",[v._v("类型")])]),v._v(" "),_("th",[_("strong",[v._v("必填")])]),v._v(" "),_("th",[_("strong",[v._v("说明")])])])]),v._v(" "),_("tbody",[_("tr",[_("td",[v._v("content")]),v._v(" "),_("td",[v._v("string")]),v._v(" "),_("td",[v._v("是")]),v._v(" "),_("td",[v._v("文本内容")])]),v._v(" "),_("tr",[_("td",[v._v("msg_type")]),v._v(" "),_("td",[v._v("int")]),v._v(" "),_("td",[v._v("是")]),v._v(" "),_("td",[v._v("消息类型： 0 文本，2 是 markdown，3 ark 消息，4 embed，7 media 富媒体")])]),v._v(" "),_("tr",[_("td",[v._v("markdown")]),v._v(" "),_("td",[v._v("object")]),v._v(" "),_("td",[v._v("否")]),v._v(" "),_("td",[_("RouterLink",{attrs:{to:"/develop/api-v2/server-inter/message/type/markdown.html#数据结构与协议"}},[v._v("Markdown")]),v._v("对象")],1)]),v._v(" "),_("tr",[_("td",[v._v("keyboard")]),v._v(" "),_("td",[v._v("object")]),v._v(" "),_("td",[v._v("否")]),v._v(" "),_("td",[_("RouterLink",{attrs:{to:"/develop/api-v2/server-inter/message/trans/msg-btn.html#数据结构与协议"}},[v._v("Keyboard")]),v._v("对象")],1)]),v._v(" "),_("tr",[_("td",[v._v("media")]),v._v(" "),_("td",[v._v("object")]),v._v(" "),_("td",[v._v("否")]),v._v(" "),_("td",[_("RouterLink",{attrs:{to:"/develop/api-v2/server-inter/message/send-receive/rich-media.html#用于群聊"}},[v._v("富媒体群聊")]),v._v("的file_info")],1)]),v._v(" "),_("tr",[_("td",[v._v("ark")]),v._v(" "),_("td",[v._v("object")]),v._v(" "),_("td",[v._v("否")]),v._v(" "),_("td",[_("RouterLink",{attrs:{to:"/develop/api-v2/server-inter/message/type/ark.html#数据结构与协议"}},[v._v("Ark")]),v._v("对象")],1)]),v._v(" "),_("tr",[_("td",[v._v("message_reference")]),v._v(" "),_("td",[v._v("object")]),v._v(" "),_("td",[v._v("否")]),v._v(" "),_("td",[v._v("【暂未支持】消息引用")])]),v._v(" "),_("tr",[_("td",[v._v("event_id")]),v._v(" "),_("td",[v._v("string")]),v._v(" "),_("td",[v._v("否")]),v._v(" "),_("td",[v._v('前置收到的事件 ID，用于发送被动消息，支持事件："INTERACTION_CREATE"、"GROUP_ADD_ROBOT"、"GROUP_MSG_RECEIVE"')])]),v._v(" "),_("tr",[_("td",[v._v("msg_id")]),v._v(" "),_("td",[v._v("string")]),v._v(" "),_("td",[v._v("否")]),v._v(" "),_("td",[v._v("前置收到的用户发送过来的消息 ID，用于发送被动消息（回复）")])]),v._v(" "),_("tr",[_("td",[v._v("msg_seq")]),v._v(" "),_("td",[v._v("int")]),v._v(" "),_("td",[v._v("否")]),v._v(" "),_("td",[v._v("回复消息的序号，与 msg_id 联合使用，避免相同消息id回复重复发送，不填默认是 1。相同的 msg_id + msg_seq 重复发送会失败。")])])])]),v._v(" "),_("ul",[_("li",[_("strong",[v._v("返回参数")])])]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[_("strong",[v._v("属性")])]),v._v(" "),_("th",[_("strong",[v._v("类型")])]),v._v(" "),_("th",[_("strong",[v._v("说明")])])])]),v._v(" "),_("tbody",[_("tr",[_("td",[v._v("id")]),v._v(" "),_("td",[v._v("string")]),v._v(" "),_("td",[v._v("消息唯一 ID")])]),v._v(" "),_("tr",[_("td",[v._v("timestamp")]),v._v(" "),_("td",[v._v("int")]),v._v(" "),_("td",[v._v("发送时间")])])])]),v._v(" "),_("ul",[_("li",[_("strong",[v._v("常见错误码")])]),v._v(" "),_("li",[v._v("当 msg_type = 7 时，content 字段需要填入一个值，譬如一个空格 “ ”，后续版本会修复该问题。")])]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[_("strong",[v._v("code")])]),v._v(" "),_("th",[_("strong",[v._v("message")])]),v._v(" "),_("th",[_("strong",[v._v("说明")])])])]),v._v(" "),_("tbody",[_("tr",[_("td",[v._v("22009")]),v._v(" "),_("td",[v._v("msg limit exceed")]),v._v(" "),_("td",[v._v("消息发送超频")])]),v._v(" "),_("tr",[_("td",[v._v("304082")]),v._v(" "),_("td",[v._v("upload media info fail")]),v._v(" "),_("td",[v._v("富媒体资源拉取失败，请重试")])]),v._v(" "),_("tr",[_("td",[v._v("304083")]),v._v(" "),_("td",[v._v("convert media info fail")]),v._v(" "),_("td",[v._v("富媒体资源拉取失败，请重试")])])])]),v._v(" "),_("h2",{attrs:{id:"文字子频道"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#文字子频道"}},[v._v("#")]),v._v(" 文字子频道")]),v._v(" "),_("div",{staticClass:"custom-block tip"},[_("p",{staticClass:"custom-block-title"},[v._v("说明")]),v._v(" "),_("p",[v._v("发动消息到文字子频道。")])]),v._v(" "),_("ul",[_("li",[_("strong",[v._v("请求")]),v._v(" "),_("table",[_("tr",[_("th",{attrs:{colspan:"2"}},[v._v("基本")])]),v._v(" "),_("tr",[_("td",[v._v("HTTP URL")]),v._v(" "),_("td",[v._v("/channels/{channel_id}/messages")])]),v._v(" "),_("tr",[_("td",[v._v("HTTP Method")]),v._v(" "),_("td",[v._v("POST")])])])]),v._v(" "),_("li",[_("strong",[v._v("详细文档")]),v._v(" "),_("RouterLink",{attrs:{to:"/develop/api-v2/server-inter/message/post_messages.html"}},[v._v("发送消息|QQ机器人文档")])],1)]),v._v(" "),_("h2",{attrs:{id:"频道私信"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#频道私信"}},[v._v("#")]),v._v(" 频道私信")]),v._v(" "),_("p",[v._v("发动消息到频道私信，请求参数与文字子频道发送消息参数一致")]),v._v(" "),_("ul",[_("li",[_("strong",[v._v("请求")]),v._v(" "),_("table",[_("tr",[_("th",{attrs:{colspan:"2"}},[v._v("基本")])]),v._v(" "),_("tr",[_("td",[v._v("HTTP URL")]),v._v(" "),_("td",[v._v("/dms/{guild_id}/messages")])]),v._v(" "),_("tr",[_("td",[v._v("HTTP Method")]),v._v(" "),_("td",[v._v("POST")])])])]),v._v(" "),_("li",[_("strong",[v._v("详细文档")]),v._v(" "),_("RouterLink",{attrs:{to:"/develop/api-v2/server-inter/message/dms/post_dms_messages.html"}},[v._v("发送私信|QQ机器人文档")])],1)])])}),[],!1,null,null,null);_.default=d.exports}}]);