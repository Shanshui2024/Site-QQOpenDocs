(window.webpackJsonp=window.webpackJsonp||[]).push([[323],{798:function(t,s,a){"use strict";a.r(s);var n=a(11),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"python-sdk-接入指南"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#python-sdk-接入指南"}},[t._v("#")]),t._v(" Python SDK 接入指南")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://img.shields.io/pypi/v/qq-botpy",alt:"PyPI"}})]),t._v(" "),s("h2",{attrs:{id:"sdk-安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sdk-安装"}},[t._v("#")]),t._v(" sdk 安装")]),t._v(" "),s("p",[t._v("外发版本通过下面方式安装")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("pip "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" qq-botpy\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("blockquote",[s("p",[t._v("更新包的话需要添加 "),s("code",[t._v("--upgrade")]),t._v(" "),s("code",[t._v("兼容版本：python3.8+")])])]),t._v(" "),s("h2",{attrs:{id:"sdk-使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sdk-使用"}},[t._v("#")]),t._v(" sdk 使用")]),t._v(" "),s("p",[t._v("需要使用的地方"),s("code",[t._v("import botpy")])]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" botpy\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h3",{attrs:{id:"兼容提示"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#兼容提示"}},[t._v("#")]),t._v(" 兼容提示")]),t._v(" "),s("blockquote",[s("p",[t._v("原机器人的老版本"),s("code",[t._v("qq-bot")]),t._v("仍然可以使用，但新接口的支持上会逐渐暂停，此次升级不会影响线上使用的机器人")])]),t._v(" "),s("h2",{attrs:{id:"示例机器人"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例机器人"}},[t._v("#")]),t._v(" 示例机器人")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/tencent-connect/botpy/tree/master/examples",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("examples")]),s("OutboundLink")],1),t._v(" 目录下存放示例机器人，可供实现参考。")]),t._v(" "),s("h2",{attrs:{id:"botpy-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#botpy-api"}},[t._v("#")]),t._v(" botpy-API")]),t._v(" "),s("p",[t._v("基于 "),s("a",{attrs:{href:"https://bot.q.qq.com/wiki/develop/api/",target:"_blank",rel:"noopener noreferrer"}},[t._v("机器人开放平台API"),s("OutboundLink")],1),t._v(" 实现的 API 接口封装。")]),t._v(" "),s("h3",{attrs:{id:"快速示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#快速示例"}},[t._v("#")]),t._v(" 快速示例")]),t._v(" "),s("p",[t._v("通过继承实现"),s("code",[t._v("bot.Client")]),t._v(", 实现自己的机器人Client")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" botpy\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" botpy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("types"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Message\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyClient")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("botpy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on_at_message_create")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("api"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("post_message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("channel_id"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" content"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"content"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nintents "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" botpy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Intents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("public_guild_messages"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \nclient "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" MyClient"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("intents"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("intents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nclient"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("appid"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("appid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" token"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("token"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br")])]),s("h2",{attrs:{id:"botpy-事件监听"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#botpy-事件监听"}},[t._v("#")]),t._v(" botpy-事件监听")]),t._v(" "),s("p",[t._v("异步模块基于 websocket 技术用于监听频道内的相关事件，如消息、成员变化等事件，用于开发者对事件进行相应的处理。")]),t._v(" "),s("p",[t._v("更完整的事件说明，请参考 "),s("a",{attrs:{href:"https://bot.q.qq.com/wiki/develop/pythonsdk/websocket/listen_events.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("事件监听"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"订阅事件的方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#订阅事件的方法"}},[t._v("#")]),t._v(" 订阅事件的方法")]),t._v(" "),s("h3",{attrs:{id:"方法一"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方法一"}},[t._v("#")]),t._v(" 方法一：")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("intents "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" botpy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Intents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \nclient "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" MyClient"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("intents"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("intents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("在Intents中填入对应的"),s("a",{attrs:{href:"#%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8"}},[t._v("参数")])]),t._v(" "),s("p",[t._v("例子：")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("intents "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" botpy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Intents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("public_guild_messages"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" direct_message"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" guilds"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h3",{attrs:{id:"方法二"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方法二"}},[t._v("#")]),t._v(" 方法二：")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("intents "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" botpy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Intents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("none"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("然后打开对应的订阅("),s("a",{attrs:{href:"#%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8"}},[t._v("参数列表")]),t._v(")")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("intents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("public_guild_messages"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\nintents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("direct_message"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\nintents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("guilds"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("p",[t._v("说明：")]),t._v(" "),s("p",[t._v("方法二对应的快捷订阅方式为")]),t._v(" "),s("ol",[s("li",[t._v("订阅所有事件")])]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("intents "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" botpy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Intents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("all")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("订阅所有的公域事件")])]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("intents "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" botpy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Intents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("default"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h3",{attrs:{id:"备注"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#备注"}},[t._v("#")]),t._v(" 备注")]),t._v(" "),s("p",[t._v("也可以通过预设置的类型，设置需要监听的事件通道")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" botpy\n\nintents "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" botpy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Intents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("none"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nintents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("public_guild_messages"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("h4",{attrs:{id:"参数列表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参数列表"}},[t._v("#")]),t._v(" 参数列表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("参数")]),t._v(" "),s("th",[t._v("含义")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("public_guild_messages")]),t._v(" "),s("td",[t._v("公域消息事件")])]),t._v(" "),s("tr",[s("td",[t._v("guild_messages")]),t._v(" "),s("td",[t._v("消息事件 "),s("strong",[t._v("(仅 "),s("code",[t._v("私域")]),t._v(" 机器人能够设置此 intents)")])])]),t._v(" "),s("tr",[s("td",[t._v("direct_message")]),t._v(" "),s("td",[t._v("私信事件")])]),t._v(" "),s("tr",[s("td",[t._v("guild_message_reactions")]),t._v(" "),s("td",[t._v("消息相关互动事件")])]),t._v(" "),s("tr",[s("td",[t._v("guilds")]),t._v(" "),s("td",[t._v("频道事件")])]),t._v(" "),s("tr",[s("td",[t._v("guild_members")]),t._v(" "),s("td",[t._v("频道成员事件")])]),t._v(" "),s("tr",[s("td",[t._v("interaction")]),t._v(" "),s("td",[t._v("互动事件")])]),t._v(" "),s("tr",[s("td",[t._v("message_audit")]),t._v(" "),s("td",[t._v("消息审核事件")])]),t._v(" "),s("tr",[s("td",[t._v("forums")]),t._v(" "),s("td",[t._v("论坛事件 "),s("strong",[t._v("(仅 "),s("code",[t._v("私域")]),t._v(" 机器人能够设置此 intents)")])])]),t._v(" "),s("tr",[s("td",[t._v("audio_action")]),t._v(" "),s("td",[t._v("音频事件")])])])]),t._v(" "),s("h2",{attrs:{id:"日志打印"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#日志打印"}},[t._v("#")]),t._v(" 日志打印")]),t._v(" "),s("p",[t._v("基于自带的 logging 模块封装的日志模块，提供了日志写入以及美化了打印格式，并支持调整打印级别（默认打印级别为 "),s("code",[t._v("INFO")]),t._v("）。")]),t._v(" "),s("h3",{attrs:{id:"使用方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用方法"}},[t._v("#")]),t._v(" 使用方法")]),t._v(" "),s("p",[t._v("引用模块，并获取 "),s("code",[t._v("logger")]),t._v(" 实例：")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" botpy "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" logging\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("或者通过"),s("code",[t._v("botpy.logger")]),t._v("也可以获取logger对象")]),t._v(" "),s("p",[t._v("然后就可以愉快地使用 logger 进行打印。例如：")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" botpy "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" logger\n\nlogger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello world!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("h3",{attrs:{id:"日志设置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#日志设置"}},[t._v("#")]),t._v(" 日志设置")]),t._v(" "),s("p",[t._v("SDK的日志设置集成在"),s("code",[t._v("bot.Client")]),t._v("的实例化阶段，也可通过"),s("a",{attrs:{href:"botpy/logging.py"}},[s("code",[t._v("logging.configure_logging")])]),t._v("修改(均为可选)")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" botpy\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 示例，非默认值")]),t._v("\nbotpy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    log_level"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    log_format"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"new format"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    bot_log"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ext_handlers"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    log_config"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"log_config.json"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br")])]),s("h3",{attrs:{id:"log-level"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#log-level"}},[t._v("#")]),t._v(" log_level")]),t._v(" "),s("p",[t._v("日志级别，默认为"),s("code",[t._v("INFO")])]),t._v(" "),s("p",[t._v("命令行启动py可增加参数"),s("code",[t._v("-d")]),t._v(" 或 "),s("code",[t._v("--debug")]),t._v("快捷打开debug日志")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("python3 demo_at_reply.py "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("几个可选取值（参考了"),s("a",{attrs:{href:"https://docs.python.org/3/library/logging.html#levels",target:"_blank",rel:"noopener noreferrer"}},[t._v("logging模块的取值"),s("OutboundLink")],1),t._v("）：")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("Level")]),t._v(" "),s("th",[t._v("取值")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("CRITICAL")]),t._v(" "),s("td",[t._v("50")])]),t._v(" "),s("tr",[s("td",[t._v("ERROR")]),t._v(" "),s("td",[t._v("40")])]),t._v(" "),s("tr",[s("td",[t._v("WARNING")]),t._v(" "),s("td",[t._v("30")])]),t._v(" "),s("tr",[s("td",[t._v("INFO")]),t._v(" "),s("td",[t._v("20")])]),t._v(" "),s("tr",[s("td",[t._v("DEBUG")]),t._v(" "),s("td",[t._v("10")])]),t._v(" "),s("tr",[s("td",[t._v("NOTSET")]),t._v(" "),s("td",[t._v("0")])])])]),t._v(" "),s("h3",{attrs:{id:"log-format"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#log-format"}},[t._v("#")]),t._v(" log_format")]),t._v(" "),s("p",[t._v("日志控制台输出格式，默认为 "),s("code",[t._v('"\\033[1;33m[%(levelname)s]\\t(%(filename)s:%(lineno)s)%(funcName)s\\t\\033[0m%(message)s"')])]),t._v(" "),s("h3",{attrs:{id:"bot-log"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bot-log"}},[t._v("#")]),t._v(" bot_log")]),t._v(" "),s("p",[t._v("是否启用"),s("code",[t._v("botpy")]),t._v("日志，默认为"),s("code",[t._v("True")])]),t._v(" "),s("p",[s("code",[t._v("True")]),t._v(" 启用"),s("br"),t._v(" "),s("code",[t._v("None")]),t._v(" 禁用 拓展"),s("br"),t._v(" "),s("code",[t._v("False")]),t._v(" 禁用 拓展+控制台输出")]),t._v(" "),s("h3",{attrs:{id:"ext-handlers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ext-handlers"}},[t._v("#")]),t._v(" ext_handlers")]),t._v(" "),s("p",[t._v("日志Handler拓展，为"),s("code",[t._v("True")]),t._v("使用默认拓展，"),s("code",[t._v("False")]),t._v("不添加拓展，可用list添加多个拓展。默认为"),s("code",[t._v("True")])]),t._v(" "),s("p",[s("a",{attrs:{href:"./botpy/logging.py"}},[t._v("默认拓展")])]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" os\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" logging\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" logging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("handlers "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" TimedRotatingFileHandler\n\nDEFAULT_FILE_HANDLER "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 要实例化的Handler")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"handler"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" TimedRotatingFileHandler"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可选 Default to DEFAULT_FILE_FORMAT")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"format"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%(asctime)s\\t[%(levelname)s]\\t(%(filename)s:%(lineno)s)%(funcName)s\\t%(message)s"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可选 Default to DEBUG")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"level"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" logging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DEBUG"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 以下是Handler相关参数")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"when"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"backupCount"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"encoding"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"utf-8"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# *特殊* 对于filename参数，其中如有 %(name)s 会在实例化阶段填入相应的日志name")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"filename"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" os"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("os"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getcwd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%(name)s.log"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br")])]),s("h4",{attrs:{id:"修改默认拓展"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#修改默认拓展"}},[t._v("#")]),t._v(" 修改默认拓展")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" os\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" botpy\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" botpy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("logging "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" DEFAULT_FILE_HANDLER\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 修改日志路径")]),t._v("\nDEFAULT_FILE_HANDLER"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"filename"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" os"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("os"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getcwd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"log"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%(name)s.log"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 修改日志格式")]),t._v("\nDEFAULT_FILE_HANDLER"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"format"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"new format"')]),t._v("\n\nbotpy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ext_handlers"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("DEFAULT_FILE_HANDLER"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br")])]),s("h3",{attrs:{id:"log-config"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#log-config"}},[t._v("#")]),t._v(" log_config")]),t._v(" "),s("p",[t._v("该参数将传入"),s("code",[t._v("logging.config.dictConfig")]),t._v("(内置logging而非botpy.logging)，如果为.json/.yaml文件路径将从文件中读取配置，无默认值")])])}),[],!1,null,null,null);s.default=e.exports}}]);